apiVersion: v1
kind: ConfigMap
metadata:
  name: tekton-pipeline-template-dev-external
  namespace: {{ .Release.Namespace }}
  labels:
    app.kubernetes.io/component: pipeline-template
    app.kubernetes.io/name: component-operator
    component.kagenti.ai/mode: dev-external
data:
  template.json: |
    {
      "name": "Development Pipeline (External Registry)",
      "namespace": {{ .Release.Namespace }},     
      "description": "Basic pipeline for development builds with external registry authentication",
      "requiredParameters": [
        "repo-url",
        "revision",
        "subfolder-path",
        "image"
      ],
      "steps": [
        {
          "name": "github-clone",
          "configMap": "tekton-github-clone-step",
          "enabled": true,
          "description": "Clone source code from GitHub repository",
          "requiredParameters": ["repo-url"]
        },
        {
          "name": "folder-verification",
          "configMap": "tekton-check-subfolder-step",
          "enabled": true,
          "description": "Verify that the specified subfolder exists",
          "requiredParameters": ["subfolder-path"]
        },
        {
          "name": "kaniko-build",
          "configMap": "tekton-kaniko-docker-build-step-external",
          "enabled": true,
          "description": "Build container image using Kaniko with registry authentication",
          "requiredParameters": ["image"]
        }
      ],
      "globalParameters": [
        {
          "name": "pipeline-timeout",
          "value": "20m",
          "description": "Overall pipeline timeout"
        }
      ]
    }
